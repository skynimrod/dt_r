参见:

     http://blog.sina.com.cn/s/blog_60f9c00501015siq.html

# 3 Data Analysis Commands 18
# 3.2 DataSets ..................................... 20
# 3.2.1 DataStructures .............................. 20
# 3.2.2 LoadingData ............................... 20
# 3.2.3 SavingData ................................ 22
#############################################################

3.2 数据集
3.2.1 数据结构
Zelig仅使用R大量数据结构中的三种：# 所以我前面推荐对于Zelig不要设为默认载入，在需要时手动载入。
  1. 变量是一个长度为n的一维向量。
  2. 数据框是一个n行k列的矩形矩阵。每列代表一个变量，每行是一个观测值。每个变量可以是不同的类型(#同一变量必需同一类型)。(见3.3.1类的列表)你可以用提取符号$来从数据框查看指定的变量，例如：data$variable。
  3. 列表是不同数据结构的组合。例如，z.out含有两个系数(向量)和数据(数据框)。使用names()来查看列表中的变量元素，运算符.用来查阅列表中的元素。更多综合介绍，包括管理数据结构的途径，请参考第6章。

3.2.2 载入数据
  Zelig中的数据集保存在中"data frames"。在此，我们解释从硬盘载入数据到内在的标准方法，怎么处理指定的记录？怎么验证你载入的数据就是你需要的？

载入数据的标准方法

确信数据保存在你的当前工作目录中。在开始运行R时，你可以检查证实你的当前工作目录有些什么东西，键入getwd()。如果你想使用与开始目录不同的目录，使用setwd("dirpath")，在此"dirpath"是你将用它来作你工作目录的全路径。(即指定在哪个盘符下某个文件夹下的某个文件……)。

# 也可以用R控制台工具栏"文件"_"改变当前目录"_"游览"来指定你的当前工作目录，这样是为了方便在载入数据或保存数据时输入一长串的路径符。

当你认定好当前工作目录，载入数据使用下面的方法之一：
  1. 如果你的数据是以制表符tab-或空格分隔的.txt文件，使用read.tale("mydata.txt")。
  2. 如果你的数据是以逗号分隔符的表，用read.csv("mydata.txt")。
  3. 导入SPSS、Stata和其它数据文件，使用foreign程序包，对每个变量它自动饯域其特性。因此，在Stata中作为日期变量的类被自动转成R中日期类的值。例如：
> library(foreign) # 载入 foreign包
> stata.data <-read.dta("mydata.dta") # 读取的是Stata data软件保存的数据。
> spss.data <-read.spss("mydata.sav", to.data.frame = TRUE) # 读取的SPSS保存的数据，读取SPSS保存的数据，在我国遇到较多问题，详情已在本论坛有关贴中阐述，请查阅，关键点就是变量名不能带中文字符或者说不带双字节符号。
  4. 载入R格式的数据，使用load("mydata.RData")。# 这与我们平时的习惯不同，大家往往都习惯于双击文件来打开，R中不是这样，并且载入的数据要用命令才能查看。
  5. 在R包中的示例样本数据集，如Zelig，你可以使用data()命令，它快捷地从样本数据目录中载入数据。因为在安装时这此当前目录可能有改动，使用先前三种方法对当前的样本数据很困难找到时;用data()在载入包中的所历当前样本数据集和自动载入样本数据集。例如：
> library(Zelig) # 载入Zelig 包。
> data(turnout) # 载入turnout数据。

载入数据时需要指定载入对象的格式(Special Cases When Loading Data )

这些操作可以用上面read命令中之一来读取。
  1. 如果你的文件第一行是标识为变量名，你应该使用选项header=TRUE来导入名字字段。例如：
  > read.csv("mydata.csv", header = TRUE)
  将会读取第1行的字词为变量名接下来的行(作为初始值，值的数目要相同，即各变量的元素组成向量的长度要等长，同一变量下的值类型要相同)为对应变量名的观测值。如果你在文件的最后一行或少数其它行中添加字符，在读取数据前，请先编辑一下，变成相同类型再读取。
  2. R中缺失的代码是NA。如果你数据中的缺失也是这样，R将同样把它当成缺失值NA载入。相反，如果你是用一些占位符(如-9)来代表缺失值，那么在载入数据时，你需要告诉R你的缺失值，如：
  > read.table("mydata.tab", header = TRUE, na.strings = "-9")
  注意：你必需把占位符的值用双引号括起来。
  3. 与Windows不一样，在R中文件的扩展名在处理文件时并不取决于默认的方法。例如，你的数据是用制表符tab为分隔符，但是保存为a.sav文件(# SPSS的数据保存格式)，read.table("mydata.sav")将会载入你的数据到R中，证实你载入的数据格式正确。

  无论你使用哪种方法，尽量用names()、dim()和summary() 命令去验证下数据是不是正确载入了。例如：
  > data <-read.csv("mydata.csv", header = TRUE) # 读取(导入)数据
  > dim(data) # 显示数据框的维数(即结构)
  [1] 16000 8 # 先是行后是列，16000行，8列
  > data[1:10,] # 显示所有列的第1至10行
  > names(data) # 检查变量名
  [1] "V1" "V2" "V3" # 这些值显示的就是变量名还没有命名，所取值为默认值。
  > names(data) <-c("income", "educate", "year") # 赋以变量名
  > summary(data) # 返回每个变量的五点描述(描述性统计)
  在这种情况下，summary()命令将返回最大值、最小值、平均数、中位数、上四分位数和下四分位数，也还有每个变量的缺失值。

3.2.3 保存数据
用save()把数据或任意对象在你的当前工作目录中以某文件保存。例如：

> save(mydata, file = "mydata.RData") # 在操作目录中，保存mydata为永久文件mydata.RData，该文件直到你删除或替换都在。

> save.image() # 默认是保存整个工作空间为‘.RData’文件。

当你用q()命令退出时，R也将提示你保存工作空间。当你再次启动R时，它将载入先前保存的工作空间。然而，启动R将不会载入先前用过的程序包。你必需记住，在R每次对话框开始时载入Zelig。

另一选择，你可以用load()命令从.RData文件分别调用保存的对象，例如：

> load("mydata.RData")

载入保存为mydata.RData文件的对象。你可以保存一个数据框，用相关函数把数据框或其它R对象保存为文件。

#######################
参考HSAUR包的第1章第5节 补充by areg
#######################
write.table(Forbes2000, file = "Forbes2000.csv",sep = ",", col.names = NA)
# 导出数据集Forbes2000成以.csv为扩展名的文件，此类型文件，你很方便用Excel打开。
# 如果你设置的工作目录中已有同名文件存在，它将在没有任何提示的情况下被覆盖，用其它命令保存，遇有同名文件都要小心，尤

其是在自己研究的试验数据分析时，在学习练习中就养成好习惯，是个不错的选择，以避免……。可以换成下面的命令练习一下。
write.table(Forbes2000, file = "Forbes.csv",sep = ",", col.names = NA)
# 将在你设置的工作目录中出现一个Forbes.csv文件
# 这种保存方式，或保存为文本文件的方式.txt，大家比较习惯，不用R也能打开，并且一打开就能见到数据的全貌。

save(Forbes2000, file = "Forbes2000.rda")
# 如果想看看当前工作目录中有些什么文件，用下面的命令，也即查看下刚才保存的文件是否真的保存了！
list.files(pattern = ".rda")
[1] "Forbes2000.rda"
# 保存为.Rda的R标准文件，此文件不能如我们平时打开其它文件那样打开，如打开个word，双击就打开了，而此文件的读取，需要

用下面的命令在R中打开。

load("Forbes2000.rda")
# 载入以R标准数据保存的文件。
#######################
